# 英語を話せるpro話者
- 特に、森川さん。英語を話せる森川さんを作ろう！！
- 森川さんのIDは？
- 森川さんのデータは Coefont-Cloud-16khz にあるのでこちらを使う。

## memo
- やってみてわかったが、itemsのlenは4とか5とか混ぜちゃいけなかった
    - 全てにaccentの情報を追加。言うても en は None を加えるだけ

- bug修正後。proからのこちら。

- なぜかabciでmultiとsingle GPUどっちも回すとファイルと結果のファイル全部吹き飛んだ。why?
  - この２つは混ぜたら危険？
  - AFだけなら良い？試す。
    - 関係なかった。AF２つ回してもだめでした。
  - abci側の不具合かな？とも思ったけど、プログラムがエラー終了していて、それのせいの可能性はある。ファイルが消えるのは謎だけど。。。

- エラーが出ていたのは、音素が作れていなかった(謎実装(音素にするのは一言後という仮定)のせい)
  - 直したら動いた。
  - 一方で、今度はout of memoryと長さが足りない話
  - out of memory のほうは、batchのせいではなく単に長い音声を切るべきという話
  - min maxの調整ですね。
  - min = 70, max = 400 で行けたっぽい

- ↑この設定で、253step/epoch で結構想像より遅い。これで本当に8GPU?
    - 1epoch大体
    - おそらく、1stepで8batch分をやっていると予想
    - なので、試しに1GPUで動かしたら8倍のstep数が出ると思われる。
    - やってみた
        - 設定は全く同じ。何も変えないでノードだけ1GPUのやつにしてみた。
        - やはり、予想通り「2027step/epoch」である
        - 25stepの処理に大体「35s」かかっている(手元で測定した)
        - 一方、8GPUの方だと25stepに大体「39s」かかっている
        - もちろんシャッフルされたデータにもよるので、一概には言えないけれど、ほとんど同じなのでまさに「実質8倍速」になっている。

- 結局、エラー終了したらログも残さず消えるという厄介実装はそのままだけど、なんとか動くところにこぎつけた。
- メインで修正舌部分は以下:
    - Coquit で言われている通りの実行方法を試した
    - logを作れるように無理やりsleepを挟んだ
    - self.phoneme_lang の実装を修正してちゃんと多言語でphonemeを扱えるようにした
    - 音素のmin/maxの調整
        - ただ、これは本当は言語ごとにやりたいし、音素でフィルターよりも実際の音声長でフィルターかけたい
        - 少なくとも、日本語音声は切らないようにしたい
